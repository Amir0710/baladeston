class VerifyRepositoryImpl implements VerifyRepository {
  final VerificationApi _api;

  VerifyRepositoryImpl(this._api);

  @override
  Future<Result<VerifyEntity>> sendVerificationCode(String phone) async {
    try {
      await _api.sendCode(phone);
      return Result.success(
        VerifyEntity(
          phone: phone,
          isVerified: false,
          verifiedAt: DateTime.now(),
        ),
      );
    } catch (e) {
      return Result.failure(Exception(e.toString()));
    }
  }

  @override
  Future<Result<VerifyEntity>> checkVerificationCode(
      String phone, String code) async {
    try {
      final model = await _api.verifyCode(phone, code);
      final entity = VerifyMapper.fromModel(model, phone);
      return Result.success(entity);
    } catch (e) {
      return Result.failure(Exception(e.toString()));
    }
  }
}
